(this["webpackJsonpfile-automation"]=this["webpackJsonpfile-automation"]||[]).push([[0],{104:function(e,t,a){e.exports=a(139)},109:function(e,t,a){},114:function(e,t){},115:function(e,t){},139:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(10),o=a.n(r),c=(a(109),a(190)),i=a(7),s=a(180),m=a(186),u=a(192),p=a(22),f=a(187),d=a(188),h=a(64),b=a(6),g=a(19),E=Object(s.a)({grow:{flexGrow:1},linkContainer:{display:"flex"},link:{margin:"5px",padding:"10px 20px 10px 20px",backgroundColor:"#f8f8f8",color:"#434343",textDecoration:"none",borderRadius:"5px",transition:"0.5s",textTransform:"uppercase",fontSize:"1em",fontWeight:"bold","&:hover":{backgroundColor:"#d5d5d5",transition:"0.5s"}},root:{marginTop:"50px",justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column",height:"100%"},label:{fontWeight:"bold",fontSize:"20px",paddingTop:"5px",paddingBottom:"5px",width:"100%",textAlign:"left"},inputWrapper:{margin:"20px 0px"},input:{padding:"5px"},download:{backgroundColor:"darkorange",color:"white",width:"180px",height:"50px",borderRadius:"5px",fontSize:"1.1em",border:"none",transition:"1s",textTransform:"uppercase","&:hover":{backgroundColor:"#ff6500",transition:"1s",cursor:"pointer"}},fileUploadContainer:{padding:"10px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",width:"80%"},fileUploadWrapper:{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",padding:"10px"},fileUpload:{height:"60px",backgroundColor:"white",border:"none",flex:1,margin:"10px"},inputContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),y=a(183),v=function(){var e=E(),t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],o=(a[1],Object(n.useState)([])),c=Object(i.a)(o,2),s=c[0],m=c[1],u=Object(n.useState)({}),p=Object(i.a)(u,2),f=p[0],d=(p[1],function(e){if(void 0===e)return null;if("number"===typeof e)return function(e){var t=Math.floor(e-25569),a=new Date(1e3*(86400*t));return new Date(a.getFullYear(),a.getDate()-1,a.getMonth()+1)}(e);var t=e.split("/");return new Date(t[2],t[0]-1,t[1])}),h=function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){1===t?function(e){var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=a[0];n.push("Committed Qty"),n.push("Commit ETA"),n.push("Balance Qty"),n.push("Balance Qty with Commit Qty "),n.push("MOQ"),n.push("LT"),n.push("Late Commit ETA"),n.push("Week Counter"),m(n);for(var l=1;l<a.length;l++)"JIT"==a[l][5]&&(a[l][3]=d(a[l][3]),a[l][12]=d(a[l][12]),a[l][15]=d(a[l][15]),r.push(a[l]))}(e.target.result):2===t&&function(e){for(var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=1;n<a.length;n++)f[a[n][0]]={mpn:a[n][1],moq:a[n][2],lt:a[n][3]}}(e.target.result)},n.readAsBinaryString(a)};return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Plexus JIT Program"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"Plexus forecast file"),l.a.createElement(y.a,{onChange:function(e){return h(e,1)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"MPN List"),l.a.createElement(y.a,{onChange:function(e){return h(e,2)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return function(){for(var e=[],t=0;t<r.length;){for(var a=r[t][4],n=function(){var a={};r[t].forEach((function(e,t){a[s[t]]=e})),a.PlexusPartNumber in f&&(a.MOQ=f[a.PlexusPartNumber].moq,a.LT=f[a.PlexusPartNumber].lt),e.push(a),t++};t<r.length&&a==r[t][4];)n();e.push({}),e.push({})}e.forEach((function(t,a){0==Object.keys(e[a]).length&&Object.keys(e[a-1]).length>1&&e[a-1].PlexusPartNumber in f&&(t.PlexusPartNumber=f[e[a-1].PlexusPartNumber].mpn)}));var l=b.utils.json_to_sheet(e,{header:s});l["!ref"]=b.utils.encode_range({s:{r:0,c:0},e:{r:e.length+1,c:24}}),e.forEach((function(t,a){var n=a+2,r="",o="",c="",i="",s="",m="";if(Object.keys(e[a]).length>1){0==a||Object.keys(e[a-1]).length<=1&&Object.keys(e[a-2]).length<=1?(r="H".concat(n,"+I").concat(n,"+O").concat(n,"-N").concat(n),o="H".concat(n,"+I").concat(n,"+O").concat(n,"+R").concat(n,"-N").concat(n)):(r="T".concat(n-1,"-N").concat(n,"+O").concat(n),o="U".concat(n-1,"-N").concat(n,"+O").concat(n,"+R").concat(n)),c="=IF(S".concat(n,">P").concat(n,',1,"")'),i="=INT((TODAY()-P".concat(n,")/7)"),s=t.MOQ,m=t.LT;var u=b.utils.encode_cell({r:n-1,c:19}),p=b.utils.encode_cell({r:n-1,c:20}),f=b.utils.encode_cell({r:n-1,c:21}),d=b.utils.encode_cell({r:n-1,c:22}),h=b.utils.encode_cell({r:n-1,c:23}),g=b.utils.encode_cell({r:n-1,c:24});l[u]={f:r},l[p]={f:o},l[h]={f:c},l[g]={f:i},l[f]={v:s},l[d]={v:m}}}));var o={Sheets:{data:l},SheetNames:["data"]},c=b.write(o,{bookType:"xlsx",type:"array"}),i=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(i,"Data.xlsx")}()},className:e.download},"Download")))},N=a(30),x=function(){var e=E(),t=Object(n.useState)({}),a=Object(i.a)(t,2),r=a[0],o=(a[1],Object(n.useState)([])),c=Object(i.a)(o,2),s=c[0],m=(c[1],function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){1===t?function(e){for(var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=1;n<a.length;n++){var l=a[n][0];s.push(l)}}(e.target.result):2===t?function(e){for(var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=1;n<a.length;n++){var l=a[n][0],o=a[n][1],c=a[n][2],i=a[n][3];l in r?r[l].customer_date in r[l]?u(o)>u(r[l].customer_date)&&(r[l]=Object(N.a)(Object(N.a)({},r[l]),{},{customer_date:u(o),moq:c,customer_price:i})):r[l]=Object(N.a)(Object(N.a)({},r[l]),{},{customer_date:u(o),moq:c,customer_price:i}):r[l]={customer_date:u(o),moq:c,customer_price:i}}}(e.target.result):function(e){for(var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=1;n<a.length;n++){var l=a[n][0],o=a[n][1],c=a[n][2];"Forwarder :"!==l&&(o in r?r[o].receive_date in r[o]?u(l)>u(r[o].receive_date)&&(r[o]=Object(N.a)(Object(N.a)({},r[o]),{},{receive_date:u(l),supply_price:c})):r[o]=Object(N.a)(Object(N.a)({},r[o]),{},{receive_date:u(l),supply_price:c}):r[o]={receive_date:u(l),supply_price:c})}}(e.target.result)},n.readAsBinaryString(a)}),u=function(e){var t=Math.floor(e-25569),a=new Date(1e3*(86400*t));return new Date(a.getFullYear(),a.getMonth(),a.getDate())};return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Online Stock Pricing"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Stock List"),l.a.createElement(y.a,{onChange:function(e){return m(e,1)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Customer Price"),l.a.createElement(y.a,{onChange:function(e){return m(e,2)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Supplier Price"),l.a.createElement(y.a,{onChange:function(e){return m(e,3)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return function(){for(var e=[],t=0;t<s.length;t++){var a={},n=s[t];if(n in r){var l=r[n].moq,o=r[n].supply_price,c=r[n].customer_price;a["Stock Code (Max 30 Chars)"]=n,a.MOQ=void 0===l?"-":l,a["Supplier Price"]=void 0===o?"-":o,a["Customer Price"]=void 0===c?"-":c}else a["Stock Code (Max 30 Chars)"]=n,a.MOQ="-",a["Supplier Price"]="-",a["Customer Price"]="-";e.push(a)}var i={Sheets:{data:b.utils.json_to_sheet(e,{header:["Stock Code (Max 30 Chars)","MOQ","Supplier Price","Customer Price"]})},SheetNames:["data"]},m=b.write(i,{bookType:"xlsx",type:"array"}),u=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(u,"Data.xlsx")}()},className:e.download},"Download")))},O=a(95),C=function(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),r=t[0],o=t[1],c=Object(n.useState)({}),s=Object(i.a)(c,2),m=s[0],u=s[1],p=Object(n.useState)({}),f=Object(i.a)(p,2),d=f[0],h=f[1],v=Object(n.useState)(""),N=Object(i.a)(v,2),x=(N[0],N[1]),C=E(),S=function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){!function(e,t){var a=b.read(e,{type:"binary"}),n=b.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1});x(n[0][0]);for(var l=1;l<n[0].length;l++){var r=parseInt(n[0][l]);r in d||(d[r]=1)}h(d);for(var c={},i=1;i<n.length;i++){for(var s=n[i][0],m={},p=1;p<n[i].length;p++){var f=parseInt(n[0][p]),g=n[i][p];m[f]=g}c[s]=m}delete c[void 0],t?o(c):u(c)}(e.target.result,t)},n.readAsBinaryString(a)};return l.a.createElement("div",{className:C.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Price Multiplier"),l.a.createElement("div",{className:C.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:C.fileUploadWrapper},l.a.createElement("span",{className:C.label},"File 1"),l.a.createElement(y.a,{onChange:function(e){return S(e,!0)},type:"file",className:C.fileUpload})),l.a.createElement("div",{className:C.fileUploadWrapper},l.a.createElement("span",{className:C.label},"File 2"),l.a.createElement(y.a,{onChange:function(e){return S(e,!1)},type:"file",disabled:0===Object.keys(r).length,className:C.fileUpload}))),l.a.createElement("section",{className:C.fileUploadContainer},l.a.createElement("span",{className:C.label},"Mark Up Value ",l.a.createElement("span",{style:{color:"red",fontSize:"13px"}},"(numbers/ decimal only)")),l.a.createElement("div",{className:0!==Object.keys(d).length&&C.inputWrapper},Object.keys(d).map((function(e){return l.a.createElement("div",{key:e,className:C.input},l.a.createElement("label",{style:{paddingRight:"10px"}},"Q - ",e),l.a.createElement("input",{type:"number",onChange:function(t){return function(e,t){var a=JSON.parse(JSON.stringify(d));0===e.toString().length?(a[t]=1,h(a)):(a[t]=parseFloat(e),h(a))}(t.target.value,e)},value:d[e]}))}))),0===Object.keys(d).length&&l.a.createElement("div",{style:{width:"100%"}},l.a.createElement("h4",{style:{color:"#333",textTransform:"uppercase",margin:"0px",opacity:"0.8"}},"[Multiplier fields will display once file is uploaded]")),l.a.createElement("button",{onClick:function(){return function(){if(0!==Object.keys(m).length)for(var e=Object.keys(r),t=Object.keys(m),a=e.concat(t),n=Object(O.a)(new Set(a)),l=Object.keys(d),o=0;o<n.length;o++){var c={};if(void 0===r[n[o]])for(var i=0;i<l.length;i++)c[l[i]]=m[n[o]][l[i]];else if(void 0===m[n[o]])for(var s=0;s<l.length;s++)c[l[s]]=r[n[o]][l[s]];else for(var u=0;u<l.length;u++){var p=r[n[o]],f=m[n[o]];void 0===p[l[u]]?c[l[u]]=f[l[u]]:void 0===f[l[u]]?c[l[u]]=p[l[u]]:c[l[u]]=p[l[u]]<f[l[u]]?p[l[u]]:f[l[u]]}r[n[o]]=c}for(var h=Object.keys(r),E=[],y=["MPN"],v=r[h[0]],N=0;N<Object.keys(v).length;N++)y.push(Object.keys(v)[N]);for(var x=0;x<h.length;x++){var C={};C.MPN=h[x];for(var S=r[h[x]],w=Object.keys(S),j=Object.values(S),k=0;k<w.length;k++)isNaN(parseFloat(j[k]))||(C[w[k]]=j[k]*d[w[k]]);E.push(C)}var _={Sheets:{data:b.utils.json_to_sheet(E,{header:y})},SheetNames:["data"]},T=b.write(_,{bookType:"xlsx",type:"array"}),I=new Blob([T],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(I,"Data.xlsx")}()},className:C.download,disabled:0===Object.keys(r).length},"Download")),l.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"}},l.a.createElement("h3",null,"Your Uploaded File ",l.a.createElement("span",{style:{fontWeight:"bold",color:"red",fontSize:"20px"}},"MUST")," follow the following format: "),l.a.createElement("img",{alt:"Sample Format",src:a(75),width:"80%",style:{borderRadius:"10px"}})))},S=function(){var e=E(),t=Object(n.useState)({}),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)({}),s=Object(i.a)(c,2),m=s[0],u=s[1],p=function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){f(e.target.result,t)},n.readAsBinaryString(a)},f=function(e,t){for(var a=b.read(e,{type:"binary"}),n=b.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1}),l={},r=1;r<n.length;r++){var c=n[r][4],i=n[r][2],s=i+c;s in l||(l[s]={facilityNumber:i,partNumber:c})}1===t?o(l):u(l)},d=function(e,t,a){var n=[];0===t.length&&(n.push({SITE:"N/A"}),n.push({"NOT IN FORECAST":"N/A"}));for(var l=0;l<t.length;l++){var o=t[l],c={};c.SITE=r[o].facilityNumber,c["NOT IN FORECAST"]=r[o].partNumber,n.push(c)}n.push({}),n.push({SITE:""}),n.push({"NOT IN FORECAST":"NEWLY AWARDED PARTS"}),0===a.length&&(n.push({SITE:"N/A"}),n.push({"NOT IN FORECAST":"N/A"}));for(var i=0;i<a.length;i++){var s=a[i],u={};u.SITE=m[s].facilityNumber,u["NOT IN FORECAST"]=m[s].partNumber,n.push(u)}n.push({}),n.push({SITE:""}),n.push({"NOT IN FORECAST":"EXISTING BUSINESS"}),0===e.length&&(n.push({SITE:"N/A"}),n.push({"NOT IN FORECAST":"N/A"}));for(var p=0;p<e.length;p++){var f=e[p],d={};d.SITE=r[f].facilityNumber,d["NOT IN FORECAST"]=r[f].partNumber,n.push(d)}var h=b.utils.json_to_sheet(n);h["!ref"]=b.utils.encode_range({s:{r:0,c:0},e:{r:n.length+1,c:1}});var E={Sheets:{data:h},SheetNames:["data"]},y=b.write(E,{bookType:"xlsx",type:"array"}),v=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(v,"Plexus_Forecast_Comparison.xlsx")};return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Plexus Forecast Comparison"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"Old file"),l.a.createElement(y.a,{onChange:function(e){return p(e,1)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"New file"),l.a.createElement(y.a,{onChange:function(e){return p(e,2)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return function(){var e=Object.keys(r),t=Object.keys(m),a=e.filter((function(e){return t.includes(e)})),n=e.filter((function(e){return!t.includes(e)})),l=t.filter((function(t){return!e.includes(t)}));d(a,n,l)}()},className:e.download},"Export")))},w=function(){var e=E(),t=Object(n.useState)({}),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)({}),s=Object(i.a)(c,2),m=s[0],u=s[1],p=function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){f(e.target.result,t)},n.readAsBinaryString(a)},f=function(e,t){for(var a=b.read(e,{type:"binary"}),n=b.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1}),l={},r=3;r<n.length;r++){var c=n[r][2]+","+n[r][3];c in l||(l[c]=!0)}1===t?o(l):u(l)},d=function(e,t,a){var n=[];0===t.length&&n.push({"NOT IN FORECAST":"N/A"});for(var l=0;l<t.length;l++){var r=t[l].split(","),o=r[0],c=r[1],i={};i["NOT IN FORECAST"]=o,i[""]=c,n.push(i)}n.push({}),n.push({"NOT IN FORECAST":"NEWLY AWARDED PARTS"}),0===a.length&&n.push({"NOT IN FORECAST":"N/A"});for(var s=0;s<a.length;s++){var m=a[s].split(","),u=m[0],p=m[1],f={};f["NOT IN FORECAST"]=u,f[""]=p,n.push(f)}n.push({}),n.push({"NOT IN FORECAST":"EXISTING BUSINESS"}),0===e.length&&n.push({"NOT IN FORECAST":"N/A"});for(var d=0;d<e.length;d++){var h=e[d].split(","),E=h[0],y=h[1],v={};v["NOT IN FORECAST"]=E,v[""]=y,n.push(v)}var N=b.utils.json_to_sheet(n);N["!ref"]=b.utils.encode_range({s:{r:0,c:0},e:{r:n.length+1,c:1}});var x={Sheets:{data:N},SheetNames:["data"]},O=b.write(x,{bookType:"xlsx",type:"array"}),C=new Blob([O],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(C,"Jabil_Forecast_Comparison.xlsx")};return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Jabil Forecast Comparison"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"Old file"),l.a.createElement(y.a,{onChange:function(e){return p(e,1)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"New file"),l.a.createElement(y.a,{onChange:function(e){return p(e,2)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return function(){var e=Object.keys(r),t=Object.keys(m),a=e.filter((function(e){return t.includes(e)})),n=e.filter((function(e){return!t.includes(e)})),l=t.filter((function(t){return!e.includes(t)}));d(a,n,l)}()},className:e.download},"Export")))},j=a(21),k=a.n(j),_=a(32),T=a(89),I=a.n(T),A=function(){console.log("updated!");var e=E(),t=Object(n.useState)({}),a=Object(i.a)(t,2),r=(a[0],a[1],Object(n.useState)({})),o=Object(i.a)(r,2),c=(o[0],o[1],Object(n.useState)({})),s=Object(i.a)(c,2),m=s[0],u=(s[1],function(e){return""===e||void 0===e}),p=function(e,t){return e.del_date<t.del_date?-1:e.del_date>t.del_date?1:0},f=function(e){var t=86400*Math.floor(e-25569);return new Date(1e3*t)},d=function(e){for(var t=b.read(e,{type:"binary",cellDates:!1,callNF:!1,cellText:!1}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n=2;n<a.length;n++){var l=a[n][0],r=(u(a[n][1])?"":a[n][1])+"_____"+(u(a[n][2])?"":a[n][2]),o=u(a[n][3])?"":a[n][3],c=u(a[n][4])?"":a[n][4],i=u(a[n][5])?"":a[n][5];i=f(i);var s=u(a[n][6])?"":a[n][6],p=u(a[n][7])?"":a[n][7];"_____"!==r&&(r in m||(m[r]={system:[],customer:[]}),m[r].system.push({line:l,stock_code:o,del_qty:c,del_date:i,stock:s,remarks:p}));var d=u(a[n][8])?"":a[n][8],h=(u(a[n][10])?"":a[n][10])+"_____"+d,g=u(a[n][11])?"":a[n][11],E=u(a[n][12])?"":a[n][12],y=u(a[n][13])?"":a[n][13];y=f(y);var v=u(a[n][14])?"":a[n][14];"_____"!==h&&(h in m||(m[h]={system:[],customer:[]}),m[h].customer.push({line:g,del_qty:E,del_date:y,remarks:v}))}console.log(m)},h=function(){var e=Object(_.a)(k.a.mark((function e(){var t,a,n,l,r,o,c,s,u,f,d,h,b,E,y,v,N,x,O,C,S;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new I.a.Workbook,a=t.addWorksheet("My Sheet"),n={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},a.getCell("A1").value="SYSTEM SCHEDULE",a.getCell("A1").border=n,a.getCell("A1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},l=a.getCell("I1"),a.getCell("I1").border=n,l.value="CUSTOMER RESCHEDULE",a.getCell("I1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFC000"}},a.mergeCells("A1","H1"),a.mergeCells("I1","L1"),a.getCell("A1").alignment={vertical:"middle",horizontal:"center"},a.getCell("I1").alignment={vertical:"middle",horizontal:"center"},a.addRow(["Line","CPO Number","CPN","Stock Code","Del-Qty","Del-Date","Stock","Remarks","Report Line","Open PO Qty","Reschedule Date","Action Request"]),r={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},a.getCell("A2").fill=r,a.getCell("B2").fill=r,a.getCell("C2").fill=r,a.getCell("D2").fill=r,a.getCell("E2").fill=r,a.getCell("F2").fill=r,a.getCell("G2").fill=r,a.getCell("H2").fill=r,a.getCell("A2").border=n,a.getCell("B2").border=n,a.getCell("C2").border=n,a.getCell("D2").border=n,a.getCell("E2").border=n,a.getCell("F2").border=n,a.getCell("G2").border=n,a.getCell("H2").border=n,o={type:"pattern",pattern:"solid",fgColor:{argb:"D0CECE"}},a.getCell("I2").fill=o,a.getCell("J2").fill=o,a.getCell("K2").fill=o,a.getCell("L2").fill=o,a.getCell("I2").border=n,a.getCell("J2").border=n,a.getCell("K2").border=n,a.getCell("L2").border=n,c=0,s=Object.entries(m);c<s.length;c++)for(u=Object(i.a)(s[c],2),f=u[0],d=u[1],h=f.split("_____"),b=Object(i.a)(h,2),E=b[0],y=b[1],(v=d.system).sort((function(){return p})),(N=d.customer).sort((function(){return p})),x=Math.max(v.length,N.length),O=0;O<x;O++)(C=Array(12).fill("-"))[1]=E,C[2]=y,"undefined"!==typeof v[O]&&(C[0]=v[O].line,C[3]=v[O].stock_code,C[4]=v[O].del_qty,C[5]=v[O].del_date,C[6]=v[O].stock,C[7]=v[O].remarks),"undefined"!==typeof N[O]&&(C[8]=N[O].line,C[9]=N[O].del_qty,C[10]=N[O].del_date,C[11]=N[O].remarks),a.addRow(C);return e.next=45,t.xlsx.writeBuffer();case 45:S=e.sent,Object(g.saveAs)(new Blob([S]),"Rescheduled.xlsx");case 47:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Reschedule Report"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"Rescheduler upload file"),l.a.createElement(y.a,{onChange:function(e){return function(e){e.preventDefault();var t=e.target.files[0],a=new FileReader;a.onload=function(e){d(e.target.result)},a.readAsBinaryString(t)}(e)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return h()},className:e.download},"Export")))},U=a(55),D=a(92),F=a.n(D),P=a(91),R=a.n(P),W=a(66),B=a.n(W),z=a(90),M=a.n(z),L=a(93),Q=a.n(L),q=a(195),J=a(185),Y=a(53),H=a.n(Y),G=function(){var e=E(),t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),m=s[0],u=s[1],p=Object(n.useState)(null),f=Object(i.a)(p,2),d=f[0],h=f[1],b=function(){var e=Object(_.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(!0),null!=d&&null!=m){e.next=5;break}return alert("ensure all files have ben uploaded before proceeding"),o(!1),e.abrupt("return");case 5:return(t=new FormData).append("old",d),t.append("new",m),e.prev=8,e.next=11,H.a.post("https://157.245.198.24/compile",t,{headers:{"Content-Disposition":"attachment; filename=output.xlsx","Content-Type":"multipart/form-data"},responseType:"arraybuffer"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","output.xlsx"),document.body.appendChild(a),a.click()})).catch((function(e){console.log(e),alert(e)}));case 11:o(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.log(e.t0),o(!1);case 18:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",textAlign:"center",fontWeight:"bold"}},"Update new Quotation file"),l.a.createElement("span",{style:{fontSize:"18px",margin:"30px 0px 30px 0px",textAlign:"left",fontWeight:"normal"}},"Quotation File Type = Export quotation from system ",l.a.createElement("br",null),"Output file will follow the template of New Quotation. ",l.a.createElement("br",null),"It will add in details from the old file if the CPN & MPN matches. ",l.a.createElement("br",null)),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Old File"),l.a.createElement(y.a,{onChange:function(e){return function(e){h(e.target.files[0])}(e)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"New File"),l.a.createElement(y.a,{onChange:function(e){return function(e){u(e.target.files[0])}(e)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return b()},className:e.download},"Compile")),l.a.createElement(q.a,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:r,style:{position:"absolute",zIndex:10}},l.a.createElement(J.a,{color:"inherit"})))},V=function(){var e=E(),t=Object(n.useState)(!1),r=Object(i.a)(t,2),o=r[0],c=r[1],s=Object(n.useState)(null),m=Object(i.a)(s,2),u=m[0],p=m[1],f=Object(n.useState)(null),d=Object(i.a)(f,2),h=d[0],b=d[1],g=function(){var e=Object(_.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(!0),null!=u&&null!=h){e.next=5;break}return alert("ensure all files have ben uploaded before proceeding"),c(!1),e.abrupt("return");case 5:return(t=new FormData).append("file",u),t.append("price_list",h),e.prev=8,e.next=11,H.a.post("https://157.245.198.24/update",t,{headers:{"Content-Disposition":"attachment; filename=output.xlsx","Content-Type":"multipart/form-data"},responseType:"arraybuffer"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","output.xlsx"),document.body.appendChild(a),a.click()})).catch((function(e){console.log(e),alert(e)}));case 11:c(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.log(e.t0),c(!1);case 18:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Input Supplier Price"),l.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"}},l.a.createElement("h3",null,"Your Uploaded File ",l.a.createElement("span",{style:{fontWeight:"bold",color:"red",fontSize:"20px"}},"MUST")," follow the following format: "),l.a.createElement("img",{alt:"Sample Format",src:a(75),width:"80%",style:{borderRadius:"10px"}})),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Input File"),l.a.createElement(y.a,{onChange:function(e){return function(e){p(e.target.files[0])}(e)},type:"file",className:e.fileUpload})),l.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},l.a.createElement("span",{className:e.label},"Price List"),l.a.createElement(y.a,{onChange:function(e){return function(e){b(e.target.files[0])}(e)},type:"file",className:e.fileUpload}))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return g()},className:e.download},"Compile")),l.a.createElement(q.a,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:o,style:{position:"absolute",zIndex:10}},l.a.createElement(J.a,{color:"inherit"})))},K=[{path:"/file-automation/plexus/jit",name:"JIT Program",icon:l.a.createElement(U.a,{size:25,style:{color:"#fff"}}),component:v},{path:"/file-automation/plexus/forecast",name:"Forecast",icon:l.a.createElement(B.a,{size:25,style:{color:"#fff"}}),component:S},{path:"/file-automation/plexus/email",name:"Email",icon:l.a.createElement(M.a,{size:25,style:{color:"#fff"}}),component:S},{path:"/file-automation/jabil/forecast",name:"Forecast",icon:l.a.createElement(B.a,{size:25,style:{color:"#fff"}}),component:w},{path:"/file-automation/ecommerce/online-stock-pricing",name:"Online Stock Pricing",icon:l.a.createElement(R.a,{size:25,style:{color:"#fff"}}),component:x},{path:"/file-automation/ecommerce/compile",name:"Compile",icon:l.a.createElement(F.a,{size:25,style:{color:"#fff"}}),component:C},{path:"/file-automation/admin/reschedule",name:"Reschedule",icon:l.a.createElement(Q.a,{size:25,style:{color:"#fff"}}),component:A},{path:"/file-automation/admin/transfer-quotation",name:"Transfer Quotation",icon:l.a.createElement(U.a,{size:25,style:{color:"#fff"}}),component:G},{path:"/file-automation/admin/input-supplier-price",name:"Input Supplier Price",icon:l.a.createElement(U.a,{size:25,style:{color:"#fff"}}),component:V}],X=a(48),$=a.n(X),Z=a(47),ee=a.n(Z),te=Object(s.a)((function(e){return{toolbar:e.mixins.toolbar,"& .MuiDrawer-paperAnchorDockedLeft":{borderRightWidth:0},header:{fontSize:18,color:"#fff"},listBody:{backgroundColor:"#3f5c7c"},text:{fontSize:14,color:"#fff",marginLeft:"15px"},listItem:{"&:hover":{backgroundColor:"#324963",transition:"0.3s"},transition:"0.3s"}}})),ae=function(e){var t=te(),a=Object(n.useState)(!0),r=Object(i.a)(a,2),o=r[0],c=r[1],s=Object(n.useState)(!0),b=Object(i.a)(s,2),g=b[0],E=b[1],y=Object(n.useState)(!0),v=Object(i.a)(y,2),N=v[0],x=v[1],O=Object(n.useState)(!0),C=Object(i.a)(O,2),S=C[0],w=C[1],j=Object(n.useState)(!0),k=Object(i.a)(j,2),_=k[0],T=k[1];return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement(u.a,{onClick:function(){c(!o)}},l.a.createElement(f.a,{primary:"Plexus",className:t.header}),o?l.a.createElement(ee.a,{style:{color:"#fff"}}):l.a.createElement($.a,{style:{color:"#fff"}})),l.a.createElement(d.a,{in:o,timeout:"auto",unmountOnExit:!0,className:t.listBody},l.a.createElement(m.a,{component:"div",disablePadding:!0},l.a.createElement(u.a,{key:K[0].name,component:p.b,to:K[0].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[0].name)),l.a.createElement(u.a,{key:K[1].name,component:p.b,to:K[1].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[1].name)),l.a.createElement(u.a,{key:K[2].name,component:p.b,to:K[2].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[2].name)))),l.a.createElement(u.a,{onClick:function(){E(!g)}},l.a.createElement(f.a,{primary:"Jabil",className:t.header}),g?l.a.createElement(ee.a,{style:{color:"#fff"}}):l.a.createElement($.a,{style:{color:"#fff"}})),l.a.createElement(d.a,{in:g,timeout:"auto",unmountOnExit:!0,className:t.listBody},l.a.createElement(m.a,{component:"div",disablePadding:!0},l.a.createElement(u.a,{key:K[3].name,component:p.b,to:K[3].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[3].name)))),l.a.createElement(u.a,{onClick:function(){x(!N)}},l.a.createElement(f.a,{primary:"Ecommerce",className:t.header}),N?l.a.createElement(ee.a,{style:{color:"#fff"}}):l.a.createElement($.a,{style:{color:"#fff"}})),l.a.createElement(d.a,{in:N,timeout:"auto",unmountOnExit:!0,className:t.listBody},l.a.createElement(m.a,{component:"div",disablePadding:!0},l.a.createElement(u.a,{key:K[4].name,component:p.b,to:K[4].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[4].name)),l.a.createElement(u.a,{key:K[5].name,component:p.b,to:K[5].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[5].name)))),l.a.createElement(u.a,{onClick:function(){T(!_)}},l.a.createElement(f.a,{primary:"Quotation",className:t.header}),_?l.a.createElement(ee.a,{style:{color:"#fff"}}):l.a.createElement($.a,{style:{color:"#fff"}})),l.a.createElement(d.a,{in:_,timeout:"auto",unmountOnExit:!0,className:t.listBody},l.a.createElement(m.a,{component:"div",disablePadding:!0},l.a.createElement(u.a,{key:K[7].name,component:p.b,to:K[7].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[7].name)),l.a.createElement(u.a,{key:K[8].name,component:p.b,to:K[8].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[8].name)))),l.a.createElement(u.a,{onClick:function(){w(!S)}},l.a.createElement(f.a,{primary:"Admin",className:t.header}),S?l.a.createElement(ee.a,{style:{color:"#fff"}}):l.a.createElement($.a,{style:{color:"#fff"}})),l.a.createElement(d.a,{in:S,timeout:"auto",unmountOnExit:!0,className:t.listBody},l.a.createElement(m.a,{component:"div",disablePadding:!0},l.a.createElement(u.a,{key:K[6].name,component:p.b,to:K[6].path,className:t.listItem},l.a.createElement(h.a,{className:t.text},K[6].name))))))},ne=a(194),le=a(12),re=a(191),oe=a(94),ce=function(){var e=E(),t=Object(n.useState)({}),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(""),s=Object(i.a)(c,2),m=s[0],u=s[1],p=function(e){for(var t=e.toLowerCase().split(" "),a=0;a<t.length;a++)t[a]=t[a].charAt(0).toUpperCase()+t[a].substring(1);return t.join(" ")},f=function(e){return void 0===e||""===e},d=function(e){for(var t in e)if(f(t))return!0;return!1},h=function(e){for(var t=b.read(e,{type:"binary"}),a=b.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),n={},l=!1,r=1;r<a.length;r++){if(a[r].length<=0){l=!0;break}var c=a[r][0].toString(),i=a[r][1].toString(),s=a[r][3].toString(),m=a[r][4].toString(),u=a[r][5].toString();if(d([c,i,s,u,m])){l=!0;break}u in n||(n[u]=[]),n[u].push({cpn:c.trim(),stockCode:i.trim(),brand:s.trim(),name:p(m.trim())})}l?(alert("Ensure input file is in correct format"),console.log("Input file validation failed")):(console.log("Total Emails: ".concat(Object.keys(n).length)),o(n))},g=function(){var e=Object(_.a)(k.a.mark((function e(){var t,a,n,l,o,c,s,m,u,p;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(r).length){e.next=3;break}return alert("Ensure Valid file is uploaded"),e.abrupt("return");case 3:t=0,a=Object.entries(r);case 4:if(!(t<a.length)){e.next=22;break}if(n=Object(i.a)(a[t],2),l=n[0],o=n[1],void 0!==l){e.next=8;break}return e.abrupt("break",22);case 8:for(console.log(l),c=o[0].name,s='<table style="line-height:20px;width:100%;text-align:left"><tr><th>CPN</th><th>MFR</th><th>MPN</th></tr>',m="",u=0;u<o.length;u++)s+="<tr><td><strong>".concat(o[u].cpn,"</strong></td><td><strong>").concat(o[u].brand,"</strong></td><td><strong>").concat(o[u].stockCode,"</strong></td></tr>"),m+="".concat(o[u].cpn),u!==o.length-1&&(m+=", ");return p={to_email:"darryleong95@gmail.com",cpn_list:m,to_name:c,table:s+="</table>"},console.log(p),e.next=18,oe.a.send("service_l8bn2oe","template_zy4e9yq",p,"user_SsmjEgiokboVh84Izujp1").then((function(e){console.log("SUCCESS!",e.status,e.text)}),(function(e){console.log("FAILED...",e)}));case 18:return e.abrupt("break",22);case 19:t++,e.next=4;break;case 22:alert("Emails sent.");case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:e.root},l.a.createElement("span",{style:{fontSize:"30px",marginBottom:"30px",textAlign:"center",fontWeight:"bold"}},"Plexus Email"),l.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},l.a.createElement("div",{className:e.fileUploadWrapper},l.a.createElement("span",{className:e.label},"Buyer Booking Details"),l.a.createElement("div",{className:e.inputContainer},l.a.createElement(y.a,{onChange:function(e){return function(e){e.preventDefault();var t=e.target.files,a=t[0];if(void 0!==t[0]){var n=new FileReader;n.onload=function(e){h(e.target.result)},n.readAsBinaryString(a)}}(e)},type:"file",className:e.fileUpload,variant:"filled"}),l.a.createElement(re.a,{className:e.fileUpload,label:"cc-email",value:m,onChange:function(e){u(e.target.value)},rows:1,rowsMax:1,variant:"filled"})))),l.a.createElement("div",{style:{marginTop:"50px"}},l.a.createElement("button",{onClick:function(){return g()},className:e.download},"Send")))},ie=Object(s.a)((function(e){return{root:{display:"flex"},appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240},drawer:{width:240,flexShrink:0},drawerPaper:{width:240,backgroundColor:"#2e4574",border:"none"},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:e.spacing(3)}}}));var se=function(){var e=ie();return l.a.createElement("div",{className:e.root},l.a.createElement(c.a,null),l.a.createElement("nav",{className:e.drawer,"aria-label":"navigation-tabs"},l.a.createElement(ne.a,{classes:{paper:e.drawerPaper},variant:"permanent",open:!0},l.a.createElement(ae,null))),l.a.createElement("main",{className:e.content},l.a.createElement("div",{className:e.toolbar}),l.a.createElement(le.c,null,l.a.createElement(le.a,{path:"/file-automation/plexus/jit",render:function(){return l.a.createElement(v,null)}}),l.a.createElement(le.a,{path:"/file-automation/plexus/forecast",render:function(){return l.a.createElement(S,null)}}),l.a.createElement(le.a,{path:"/file-automation/plexus/email",render:function(){return l.a.createElement(ce,null)}}),l.a.createElement(le.a,{path:"/file-automation/jabil/forecast",render:function(){return l.a.createElement(w,null)}}),l.a.createElement(le.a,{path:"/file-automation/ecommerce/compare",render:function(){return l.a.createElement(x,null)}}),l.a.createElement(le.a,{path:"/file-automation/ecommerce/compile",render:function(){return l.a.createElement(C,null)}}),l.a.createElement(le.a,{path:"/file-automation/admin/reschedule",render:function(){return l.a.createElement(A,null)}}),l.a.createElement(le.a,{path:"/file-automation/admin/transfer-quotation",render:function(){return l.a.createElement(G,null)}}),l.a.createElement(le.a,{path:"/file-automation/admin/input-supplier-price",render:function(){return l.a.createElement(V,null)}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(p.a,null,l.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},74:function(e,t){},75:function(e,t,a){e.exports=a.p+"static/media/Format.8dacd377.png"}},[[104,1,2]]]);
//# sourceMappingURL=main.cf894d14.chunk.js.map